# Default server configuration for SaaS Orchestrator
# This file is managed by the SaaS Orchestrator platform

server {
    listen 80 default_server;
    listen [::]:80 default_server;
    
    server_name {{ ansible_default_ipv4.address }} {{ ansible_hostname }} localhost;
    
    root /var/www/html;
    index index.html index.htm index.nginx-debian.html;
    
    # Security headers
    add_header X-Content-Type-Options nosniff;
    add_header X-Frame-Options DENY;
    add_header X-XSS-Protection "1; mode=block";
    
    # Disable server signature
    server_tokens off;
    
    location / {
        try_files $uri $uri/ =404;
    }
    
    # Health check endpoint
    location /nginx-health {
        access_log off;
        return 200 "healthy\n";
        add_header Content-Type text/plain;
    }
    
    # Deny access to hidden files
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    
    # Logging
    access_log /var/log/nginx/default_access.log;
    error_log /var/log/nginx/default_error.log;
}